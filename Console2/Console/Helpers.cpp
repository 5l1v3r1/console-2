#include "StdAfx.h"
#include "Helpers.h"

//////////////////////////////////////////////////////////////////////////////


//////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////


//////////////////////////////////////////////////////////////////////////////

void Helpers::GetDesktopRect(HWND hWnd, CRect& rectDesktop) {

	::ZeroMemory(&rectDesktop, sizeof(CRect));

	HWND			hWndTaskbar = ::FindWindow(L"Shell_TrayWnd", L"");
	HMONITOR		hMonitor	= ::MonitorFromWindow(hWnd, MONITOR_DEFAULTTONEAREST);
	MONITORINFO		mi;

	::ZeroMemory(&mi, sizeof(MONITORINFO));
	mi.cbSize = sizeof(MONITORINFO);

	::GetMonitorInfo(hMonitor, &mi);
	rectDesktop = mi.rcMonitor;

	if (hWndTaskbar) {
		CRect rectTaskbar(0, 0, 0, 0);
		::GetWindowRect(hWndTaskbar, &rectTaskbar);
		rectDesktop.SubtractRect(&(mi.rcMonitor), rectTaskbar);
	}
}

//////////////////////////////////////////////////////////////////////////////
