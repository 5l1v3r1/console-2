#include "stdafx.h"
#include "resource.h"

#include "XmlHelper.h"
#include "DlgSettingsMain.h"

//////////////////////////////////////////////////////////////////////////////


//////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////


//////////////////////////////////////////////////////////////////////////////

DlgSettingsMain::DlgSettingsMain()
: dlgSettingsConsole(m_pOptionsRoot)
{
}

//////////////////////////////////////////////////////////////////////////////


//////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////


//////////////////////////////////////////////////////////////////////////////

LRESULT DlgSettingsMain::OnInitDialog(UINT /*uMsg*/, WPARAM /*wParam*/, LPARAM /*lParam*/, BOOL& /*bHandled*/) {

	HRESULT hr = S_OK;

	// TODO: config file
	hr = XmlHelper::OpenXmlDocument(L"console.xml", L"console.xml", m_pOptionsDocument, m_pOptionsRoot);
	if (FAILED(hr)) return FALSE;

	m_treeCtrl.Attach(GetDlgItem(IDC_TREE_SECTIONS));

/*
	TVINSERTSTRUCT	
	m_treeCtrl.InsertItem(L"Bla", 0, 0, NULL, NULL);
	m_treeCtrl.InsertItem()
*/

	CWindow wndPlaceholder(GetDlgItem(IDC_CHILD_PLACEHOLDER));
	RECT rect;
	wndPlaceholder.GetWindowRect(&rect);
	ScreenToClient(&rect);

	dlgSettingsConsole.Create(m_hWnd, rect);
	dlgSettingsConsole.ShowWindow(SW_SHOW);
	dlgSettingsConsole.SetWindowPos(HWND_TOP, rect.left, rect.top, 0, 0, SWP_NOSIZE);
	wndPlaceholder.ShowWindow(SW_HIDE);

	return TRUE;
}

//////////////////////////////////////////////////////////////////////////////


//////////////////////////////////////////////////////////////////////////////

LRESULT DlgSettingsMain::OnCloseCmd(WORD /*wNotifyCode*/, WORD wID, HWND /*hWndCtl*/, BOOL& /*bHandled*/) {

	EndDialog(wID);
	return 0;
}

//////////////////////////////////////////////////////////////////////////////
